% math
\usepackage{amsmath,amsthm,amssymb}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{assumption}{Assumption}

% math notations.
\providecommand{\lin}[1]{\ensuremath{\left\langle #1 \right\rangle}}
\providecommand{\abs}[1]{\left\lvert#1\right\rvert}
\providecommand{\norm}[1]{\left\lVert#1\right\rVert}

\providecommand{\refLE}[1]{\ensuremath{\stackrel{(\ref{#1})}{\leq}}}
\providecommand{\refEQ}[1]{\ensuremath{\stackrel{(\ref{#1})}{=}}}
\providecommand{\refGE}[1]{\ensuremath{\stackrel{(\ref{#1})}{\geq}}}
\providecommand{\refID}[1]{\ensuremath{\stackrel{(\ref{#1})}{\equiv}}}

% basec sets
\providecommand{\R}{\mathbb{R}} % Reals
\providecommand{\N}{\mathbb{N}} % Naturals

% random variables
\providecommand{\E}{{\mathbb E}}
\providecommand{\E}[1]{{\mathbb E}\left.#1\right. }        %expectation
\providecommand{\Eb}[1]{{\mathbb E}\left[#1\right] }       %expectation, with brackets
\providecommand{\EE}[2]{{\mathbb E}_{#1}\left.#2\right. }  %expectation  
\providecommand{\EEb}[2]{{\mathbb E}_{#1}\left[#2\right] } %expectation,  with brackets
\providecommand{\prob}[1]{{\rm Pr}\left[#1\right] }
\providecommand{\Prob}[2]{{\rm Pr}_{#1}\left[#2\right] }
\providecommand{\P}[1]{{\rm Pr}\left.#1\right. }
\providecommand{\Pb}[1]{{\rm Pr}\left[#1\right] }
\providecommand{\PP}[2]{{\rm Pr}_{#1}\left[#2\right] }
\providecommand{\PPb}[2]{{\rm Pr}_{#1}\left[#2\right] }
\providecommand{\derive}[2]{\frac{{\partial}{#1}}{\partial #2} }  %expectation  

% operators
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\supp}{supp}
\DeclareMathOperator*{\diag}{diag}
\DeclareMathOperator*{\Tr}{Tr}

% bold vectors
\providecommand{\0}{\mathbf{0}}
\providecommand{\1}{\mathbf{1}}
\renewcommand{\aa}{\mathbf{a}}
\providecommand{\bb}{\mathbf{b}}
\providecommand{\cc}{\mathbf{c}}
\providecommand{\dd}{\mathbf{d}}
\providecommand{\ee}{\mathbf{e}}
\providecommand{\ff}{\mathbf{f}}
\let\ggg\gg
\renewcommand{\gg}{\mathbf{g}}
\providecommand{\gv}{\mathbf{g}}
\providecommand{\hh}{\mathbf{h}}
\providecommand{\ii}{\mathbf{i}}
\providecommand{\jj}{\mathbf{j}}
\providecommand{\kk}{\mathbf{k}}
\let\lll\ll
\renewcommand{\ll}{\mathbf{l}}
\providecommand{\mm}{\mathbf{m}}
\providecommand{\nn}{\mathbf{n}}
\providecommand{\oo}{\mathbf{o}}
\providecommand{\pp}{\mathbf{p}}
\providecommand{\qq}{\mathbf{q}}
\providecommand{\rr}{\mathbf{r}}
\renewcommand{\ss}{\mathbf{s}}
\providecommand{\tt}{\mathbf{t}}
\providecommand{\uu}{\mathbf{u}}
\providecommand{\vv}{\mathbf{v}}
\providecommand{\ww}{\mathbf{w}}
\providecommand{\xx}{\mathbf{x}}
\providecommand{\yy}{\mathbf{y}}
\providecommand{\zz}{\mathbf{z}}

% bold matrices
\providecommand{\mA}{\mathbf{A}}
\providecommand{\mB}{\mathbf{B}}
\providecommand{\mC}{\mathbf{C}}
\providecommand{\mD}{\mathbf{D}}
\providecommand{\mE}{\mathbf{E}}
\providecommand{\mF}{\mathbf{F}}
\providecommand{\mG}{\mathbf{G}}
\providecommand{\mH}{\mathbf{H}}
\providecommand{\mI}{\mathbf{I}}
\providecommand{\mJ}{\mathbf{J}}
\providecommand{\mK}{\mathbf{K}}
\providecommand{\mL}{\mathbf{L}}
\providecommand{\mM}{\mathbf{M}}
\providecommand{\mN}{\mathbf{N}}
\providecommand{\mO}{\mathbf{O}}
\providecommand{\mP}{\mathbf{P}}
\providecommand{\mQ}{\mathbf{Q}}
\providecommand{\mR}{\mathbf{R}}
\providecommand{\mS}{\mathbf{S}}
\providecommand{\mT}{\mathbf{T}}
\providecommand{\mU}{\mathbf{U}}
\providecommand{\mV}{\mathbf{V}}
\providecommand{\mW}{\mathbf{W}}
\providecommand{\mX}{\mathbf{X}}
\providecommand{\mY}{\mathbf{Y}}
\providecommand{\mZ}{\mathbf{Z}}
\providecommand{\mLambda}{\boldsymbol{\Lambda}}
\providecommand{\mOmega}{\boldsymbol{\Omega}}
\providecommand{\mpi}{\boldsymbol{\pi}}
\providecommand{\malpha}{\boldsymbol{\alpha}}
\providecommand{\meta}{\boldsymbol{\eta}}
\providecommand{\mxi}{\boldsymbol{\xi}}
\providecommand{\mepsilon}{\boldsymbol{\epsilon}}
\providecommand{\mphi}{\boldsymbol{\phi}}
\providecommand{\momega}{\boldsymbol{\omega}}
\providecommand{\mdelta}{\boldsymbol{\delta}}
\providecommand{\mvarsigma}{\boldsymbol{\varsigma}}
\providecommand{\mnu}{\boldsymbol{\nu}}

% caligraphic
\providecommand{\cA}{\mathcal{A}}
\providecommand{\cB}{\mathcal{B}}
\providecommand{\cC}{\mathcal{C}}
\providecommand{\cD}{\mathcal{D}}
\providecommand{\cE}{\mathcal{E}}
\providecommand{\cF}{\mathcal{F}}
\providecommand{\cG}{\mathcal{G}}
\providecommand{\cH}{\mathcal{H}}
\providecommand{\cI}{\mathcal{I}}
\providecommand{\cJ}{\mathcal{J}}
\providecommand{\cK}{\mathcal{K}}
\providecommand{\cL}{\mathcal{L}}
\providecommand{\cM}{\mathcal{M}}
\providecommand{\cN}{\mathcal{N}}
\providecommand{\cO}{\mathcal{O}}
\providecommand{\cP}{\mathcal{P}}
\providecommand{\cQ}{\mathcal{Q}}
\providecommand{\cR}{\mathcal{R}}
\providecommand{\cS}{\mathcal{S}}
\providecommand{\cT}{\mathcal{T}}
\providecommand{\cU}{\mathcal{U}}
\providecommand{\cV}{\mathcal{V}}
\providecommand{\cX}{\mathcal{X}}
\providecommand{\cY}{\mathcal{Y}}
\providecommand{\cW}{\mathcal{W}}
\providecommand{\cZ}{\mathcal{Z}}

% textstyle math environment.
\newenvironment{talign}
{\let\displaystyle\textstyle\align}
{\endalign}
\newenvironment{talign*}
{\let\displaystyle\textstyle\csname align*\endcsname}
{\endalign}